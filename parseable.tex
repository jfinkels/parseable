%%%%
%% parseable.tex
%%
%% Copyright 2011 Jeffrey Finkelstein
%%
%% Except where otherwise noted, this work is made available under the terms of
%% the Creative Commons Attribution-ShareAlike 3.0 license,
%% http://creativecommons.org/licenses/by-sa/3.0/.
%%
%% You are free:
%%    * to Share — to copy, distribute and transmit the work
%%    * to Remix — to adapt the work
%% Under the following conditions:
%%    * Attribution — You must attribute the work in the manner specified by
%%    the author or licensor (but not in any way that suggests that they
%%    endorse you or your use of the work).
%%    * Share Alike — If you alter, transform, or build upon this work, you may
%%    distribute the resulting work only under the same, similar or a 
%%    compatible license.
%%    * For any reuse or distribution, you must make clear to others the 
%%    license terms of this work. The best way to do this is with a link to the
%%    web page http://creativecommons.org/licenses/by-sa/3.0/.
%%    * Any of the above conditions can be waived if you get permission from
%%    the copyright holder.
%%    * Nothing in this license impairs or restricts the author's moral rights.
%%%%
\documentclass[draft]{article}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{complexity}
\usepackage{float}
\usepackage{syntax}
\usepackage[pdftitle={Parsing first-order propositional logic}, pdfauthor={Jeffrey Finkelstein}]{hyperref}

\floatstyle{ruled}
\restylefloat{figure}

\newtheorem{theorem}{Theorem}

\newtheorem{conjecture}{Conjecture}
\newenvironment{sketch}{\begin{proof}[Proof sketch]}{\end{proof}}
\newenvironment{rationale}{\begin{proof}[Rationale]}{\end{proof}}

\newtheorem{todo}{TODO}
\newtheorem{proposition}{Proposition}
\theoremstyle{remark} \newtheorem{technicality}{Technical note}
\theoremstyle{definition} \newtheorem{definition}{Definition}

\long\def\symbolfootnote#1{\begingroup%
\def\thefootnote{\fnsymbol{footnote}}\footnotetext{#1}\endgroup} 
\newcommand{\makelicense}{
  Copyright 2011 Jeffrey Finkelstein.
  This work is licensed under the Creative Commons Attribution-ShareAlike License.
  To view a copy of this license, visit \mbox{\url{http://creativecommons.org/licenses/by-sa/3.0/}}}

\newcommand{\email}[1]{\href{mailto:#1}{\nolinkurl{#1}}} % formatting emails
\newcommand{\lb}{\left\{} % left curly brace for set notation
\newcommand{\rb}{\right\}} % right curly brace for set notation
\newcommand{\st}{\,\middle|\,} % ``such that'' pipe, for use in set definitions

\newenvironment{langdef}[1]{\begin{definition}{\lang{#1}}}{\end{definition}}
\newenvironment{instance}{\\Instance:}{}
\newenvironment{question}{\\Question:}{}

\newcommand{\pp}{PERM\mbox{-}PARSEABLE}
\newcommand{\pc}{PERM\mbox{-}CLOSED}

\author{Jef{}frey~Finkelstein \and Andr\'as Kornai}
\title{Parsing first-order propositional logic}
\date{\today}

\begin{document}
\maketitle
\symbolfootnote{\makelicense}

We wish to determine the complexity of deciding whether a given multiset of symbols, chosen from some finite set of symbols, can be derived according to the rules of a given context-free grammar.
We denote the set of all context-free languages by \CFL.

We define the context-free grammar of first-order predicate logic as follows.
\begin{definition}
  The language of first-order predicate logic consists of
  \begin{itemize}
  \item a set of variables $\{x_1, x_2, \ldots, x_n\}$,
  \item a set of constants $\{a_1, a_2, \ldots, a_c\}$,
  \item a set of functions $\{f^{m_1}_1, f^{m_2}_2, \ldots, f^{m_k}_k\}$, where each function $f_i$ has arity $m_i$,
  \item a set of relations (or ``propositions'') $\{R^{l_1}_1, R^{l_2}_2, \ldots, R^{l_d}_d\}$, where each relation $R_i$ has arity $l_i$, and
  \item a set of logical symbols $\{\land, \lor, \lnot, \exists, \forall, C\}$ (where $C$ represents a comma).
  \end{itemize}
  subject to the grammar described in \autoref{fig:grammar}.
  Without loss of generality, we will use Polish (prefix) notation for the grammar.
  \begin{figure}
    \caption{\label{fig:grammar}The context-free grammar specification in Backus--Naur form for first-order propositional logic (using Polish [prefix] notation).
    Here, $\lambda$ represents the empty string.}
  \begin{grammar}
    <termlist> := $\lambda$ | <term> | <term> <termlist>

    <term> := $x_i$ | $a_i$ | $f^m_i$ <termlist>

    <formula> := $R^l_i$ <termlist>
    \alt $\lor$ <formula> <formula>
    \alt $\land$ <formula> <formula>
    \alt $\lnot$ <formula>
    \alt $\exists x_i$ <formula>
    \alt $\forall x_i$ <formula>
  \end{grammar}
  \end{figure}
\end{definition}

\begin{technicality}\label{tech:arity}
  In practice, decimal numbers may be encoded using binary strings.
  Additionally, symbols with indices or arities may not be treated atomically.
  However, we can encode, for example, a function $f_i^j$ (and similarly for a relation $R_i^j$) as the string $f0^i10^j$.
  More specifically, the application of the function $f_5^3$ to the inputs $x_1$, $x_2$, and $x_3$ can be encoded as $f000001000 x1 x10 x11$.
  This allows us to drop the commas as well, since the arity of the function is specified in the prefix.
\end{technicality}

\begin{definition}
  Let $V$ be a set of variables, $A$ a set of constants, $F$ a set of functions (with their arities), $P$ a set of relations (with their arities), and $L$ the set of logical symbols.
  Let $w$ be a word over the alphabet $V\cup A\cup F\cup P\cup L$.
  Then $w$ is a \emph{well-formed formula} if there exists a parse-tree which generates $w$ according to the rules of the context-free grammar for first-order predicate logic given in the previous definition.

  A variable $x\in V$ is \emph{bound} if it is the descendant of a quantified formula in which that variable is quantified (either univerally as $\forall x$ or existentially as $\exists x$).
  The \emph{scope} of a quantifier (with respect to its quantified variable) is the smallest well-formed formula following it.
  A variable is \emph{free} if it is not bound.
  A \emph{closed formula} (or a \emph{sentence}) is a formula in which all variables appearing in the formula are bound.
\end{definition}

\begin{langdef}{PARSEABLE}
  \begin{instance}
    finite sets $V, A, F, P,$ and $L$ as described above, and $w$ a word over the alphabet $V\cup A\cup F\cup P\cup L$
  \end{instance}
  \begin{question}
    Is $w$ a well-formed formula?
  \end{question}
\end{langdef}

\begin{langdef}{CLOSED}
  \begin{instance}
    finite sets $V, A, F, P,$ and $L$ as described above, and $w$ a word over the alphabet $V\cup A\cup F\cup P\cup L$
  \end{instance}
  \begin{question}
    Is $w$ a closed well-formed formula?
  \end{question}
\end{langdef}

Let us define some complexity classes in order to help classify the complexity of these problems.
\begin{definition}\mbox{}
  \begin{itemize}
  \item $\CFL$ is the set of all context-free languages, or equivalently the set of all languages accepted by nondeterministic pushdown automata.
  \item $\DCFL$ is the set of all languages accepted by deterministic pushdown automata.
  \item $\CSL$ is the set of all context-sensitive languages, or equivalently the set of all languages accepted by linear-bounded automata.
  \item $\GCSL$ is the set of all context-sensitive languages in which the right side of each transformation in the context-sensitive grammar is either strictly longer than the left side or the left side is the start symbol.
    % from Hopcroft Ullman
  \item $\INDEXED$ is the set of all indexed languages, or equivalently the set of all languages accepted by one-way nondeterministic nested stack automata.
  \item $\AC^1$ is the set of all languages accepted by non-uniform, polynomial size, $O(\lg(n))$, unbounded fan-in circuits with AND, OR, and NOT gates.
  \item $\NC^2$ is the set of all languages accepted by uniform, polynomial size, $O(\lg^2(n))$, fan-in 2 circuits with AND, OR, and NOT gates.
  \item $\P$ is the set of all languages accepted by a deterministic Turing machine running in polynomial time.
  \item $\NSPACE(n)$ is the set of all languages accepted by a nondeterministic Turing machine using at most $n$ space, where $n$ is the length of the input.
  \item $\NLINSPACE$ is the set of all languages accepted by a nondeterministic Turing machine using space at most linear in the length of the input.
  \item $\E$ is the set of all languages accepted by a deterministic Turing machine running in $2^{O(n)}$ time.
  \item $\NSA$ is the set of all languages accepted by one-way nondeterministic stack automata.
  \end{itemize}
\end{definition}

Just for context (pun intended), here's some inclusions among these complexity classes.
Some of these inclusions are strict.
\begin{theorem}\mbox{}
  \begin{enumerate}
    % source: complexity zoo
  \item $\CFL\subseteq\AC^1\subseteq\NC^2\subseteq\P$.
    % source: complexity zoo
  \item $\CFL\subseteq\GCSL\subseteq\CSL=\NSPACE(n)\subseteq\NLINSPACE\subseteq\E$.
    % from Hopcroft, Ullman 1979, Introduction to Automata Theory, Languages,
    % and Computation
  \item $\CFL\subseteq\NSA\subseteq\INDEXED\subseteq\CSL$.
  \end{enumerate}
\end{theorem}

We know that $\lang{PARSEABLE}\in\CFL$.
We also know from \cite{mp84} that $\lang{CLOSED}\in\INDEXED\setminus\CFL$.
(In that paper, the authors also conjecture that the related problem of deciding whether a given formula has no vacuous quantifiers is \emph{not} in $\INDEXED$, though the complexity of this problem still seems to be unknown \cite{potts}.)
However, we will consider a more difficult problem.
We wish to decide whether a given multiset of symbols has a permutation which is parseable, and also whether it has a permutation which is a closed well-formed formula.

\begin{langdef}{\pp}
  \begin{instance}
    finite sets $V, A, F, P,$ and $L$ as described above, and a multiset $W$ with elements chosen from $V\cup A\cup F\cup P\cup L$
  \end{instance}
  \begin{question}
    Does there exist a permutation, $\sigma$, of the elements of $W$ such that $\sigma(W)\in\lang{PARSEABLE}$?
  \end{question}
\end{langdef}

\begin{langdef}{\pc}
  \begin{instance}
    finite sets $V, A, F, P,$ and $L$ as described above, and a multiset $W$ with elements chosen from $V\cup A\cup F\cup P\cup L$
  \end{instance}
  \begin{question}
    Does there exist a permutation, $\sigma$, of the elements of $W$ such that $\sigma(W)\in\lang{CLOSED}$?
  \end{question}
\end{langdef}

\begin{theorem}
  $\lang{\pp}\in\NP$.
\end{theorem}
\begin{proof}
  The witness is the permutation of $W$ which is parseable.
  Its size is linear with respect to the size of the input $|W|$.
  Checking whether the permutation is parseable can be performed in $p(|W|)$ time.
\end{proof}

\begin{conjecture}
  $\lang{\pp}$ is \NP-complete.
\end{conjecture}
\begin{rationale}
  The hardness of this problem comes from finding the correct permutation of the symbols of $W$.
  There are other \NP-complete problems which also require finding a permutation with some property---finding a Hamiltonian path in a directed graph, for example.
\end{rationale}

\section{About this work}

This work is licensed under the Creative Commons Attribution-ShareAlike License.
Visit \mbox{\url{https://creativecommons.org/licenses/by-sa/3.0/}} to view a copy of this license.

The \LaTeX{} markup which generated this document can be downloaded at \mbox{\url{https://github.com/jfinkels/parseable}}.
It is also licensed under the Creative Commons Attribution-ShareAlike License.

The author can be contacted via email at \email{jeffreyf@bu.edu}.

\bibliographystyle{plain}
\bibliography{bibliography}

\end{document}
